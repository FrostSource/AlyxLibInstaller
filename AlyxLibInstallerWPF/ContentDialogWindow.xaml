<Window x:Class="AlyxLibInstallerWPF.ContentDialogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ContentDialogWindow"
        WindowStyle="None"
        AllowsTransparency="False"
        Background="{DynamicResource ControlFillColorDefaultBrush}"
        ShowInTaskbar="False"
        SizeToContent="WidthAndHeight"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterOwner">

    <!-- Root grid (window background already paints the overlay/dim so we avoid extra full-screen rectangles) -->
    <Grid ClipToBounds="False">

        <!-- Center container gives the dialog breathing room so the shadow isn't clipped -->
        <Grid HorizontalAlignment="Center" VerticalAlignment="Center" Margin="28" ClipToBounds="False">

            <!-- Shadow rectangle behind the card — separate element so the shadow appears outside the card's bounds -->
            <Rectangle
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                RadiusX="12"
                RadiusY="12"
                Fill="Transparent"
                IsHitTestVisible="False"
                >
                <Rectangle.Effect>
                    <DropShadowEffect Color="#000000"
                                      BlurRadius="28"
                                      ShadowDepth="10"
                                      Opacity="0.28" />
                </Rectangle.Effect>
            </Rectangle>

            <!-- Dialog card: rounded, opaque, sizes to content -->
            <Border x:Name="DialogBorder"
                    Padding="0"
                    CornerRadius="12"
                    BorderThickness="1"
                    BorderBrush="{DynamicResource ControlOutlineColor}"
                    Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                    SnapsToDevicePixels="True"
                    MinWidth="280"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <!-- content grows to push button bar to bottom -->
                        <RowDefinition Height="Auto"/>
                        <!-- button bar -->
                    </Grid.RowDefinitions>

                    <!-- Title + content -->
                    <StackPanel Grid.Row="0" Margin="20">
                        <TextBlock x:Name="TitleBlock"
                                   Text="{Binding Title}"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                                   Margin="0,0,0,12"/>
                        <ContentPresenter x:Name="DialogContent"
                                          Content="{Binding Content}"
                                          Margin="0,0,0,12"/>
                    </StackPanel>

                    <!-- Full-width bottom band (anchored at bottom) -->
                    <Border Grid.Row="1"
                            Background="{DynamicResource SolidBackgroundFillColorBaseBrush}"
                            Padding="12,10"
                            BorderThickness="0,1,0,0"
                            BorderBrush="{DynamicResource ControlOutlineColor}">
                        <Grid>
                            <!-- left area reserved (for potential validation text); buttons centered inside the band -->
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <!-- Buttons centered in the band -->
                            <StackPanel Grid.Column="1"
                                        Orientation="Horizontal"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center">
                                <!-- Primary first (left-most) and using accent fill token -->
                                <Button x:Name="PrimaryButton"
                                        Content="{Binding PrimaryButtonText}"
                                        MinWidth="88"
                                        Height="32"
                                        Margin="0,0,8,0"
                                        Click="PrimaryButton_Click"
                                        Background="{DynamicResource AccentFillColorDefaultBrush}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}" />

                                <Button x:Name="SecondaryButton"
                                        Content="{Binding SecondaryButtonText}"
                                        MinWidth="88"
                                        Height="32"
                                        Margin="0,0,8,0"
                                        Click="SecondaryButton_Click" />

                                <Button x:Name="CloseButton"
                                        Content="{Binding CloseButtonText}"
                                        MinWidth="88"
                                        Height="32"
                                        Click="CloseButton_Click" />
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
